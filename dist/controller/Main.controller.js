sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","sap/ui/core/Fragment"],function(e,t,o){"use strict";return e.extend("nebula.controller.Main",{TIMEOUT:9e5,_logoutTimer:null,_validateSession:function(){var e=sessionStorage.getItem("authToken");var t=localStorage.getItem("authToken");if(!e&&!t){var o=this.getOwnerComponent().getRouter();o.navTo("loginRoute")}},onInit:function(){this._validateSession();this._resetLogoutTimer();this._attachUserInteractionEvents();this.oView=this.getView();this.oMyAvatar=this.oView.byId("avatar");this._oPopover=o.load({id:this.oView.getId(),name:"nebula.view.Popover",controller:this}).then(function(e){this.oView.addDependent(e);this._oPopover=e}.bind(this));this.getView().addEventDelegate({onBeforeShow:function(e){var t=window.location.href;if(!t.includes("/login")){var o=sessionStorage.getItem("authToken");var i=localStorage.getItem("authToken");if(!o&&!i)window.location.href="/"}}})},onPress:function(e){var t=e.getSource(),o=this.oMyAvatar.getActive();this.oMyAvatar.setActive(!o);if(o){this._oPopover.close()}else{this._oPopover.openBy(t)}},onPopoverClose:function(){this.oMyAvatar.setActive(false)},onListItemPress:function(){this.oMyAvatar.setActive(false);this._oPopover.close()},_attachUserInteractionEvents:function(){document.addEventListener("click",this._resetLogoutTimer.bind(this));document.addEventListener("mousemove",this._resetLogoutTimer.bind(this));document.addEventListener("keydown",this._resetLogoutTimer.bind(this))},_resetLogoutTimer:function(){if(this._logoutTimer){clearTimeout(this._logoutTimer)}if(localStorage.getItem("sKeepSigned")==true){clearTimeout(this._logoutTimer)}this._logoutTimer=setTimeout(this._onLogout.bind(this),this.TIMEOUT)},_onLogout:function(){sap.m.MessageToast.show("Você será deslogado.");var e=this.getOwnerComponent().getRouter();e.navTo("loginRoute");localStorage.clear();sessionStorage.clear()},onItemSelect:function(e){var t=e.getParameter("item");this.byId("parentNavContainer").to(this.getView().createId(t.getKey()))},onPatternMatched:function(e){var t=e.getParameter("name");var o=this.getOwnerComponent().getModel("ui");if(t==="home"||t==="main"){o.setProperty("/selectedRoute","inicioRoute1")}else{o.setProperty("/selectedRoute",t)}},onSegmentedButtonSelectionChange:function(e){var o=this.getRouter();var i=o.getHashChanger().getHash();if(o.getRouteInfoByHash(i).name==e.getParameter("item").getKey()){return}var n=new t({busy:true,delay:0});this.getOwnerComponent().setModel(n,"appView");this.navTo(e.getParameter("item").getKey())},onSelectedRouteBindingChange:function(e){this.navTo(e.getSource().getValue())},onMenuButtonPress:function(){var e=this.byId("toolPage");e.setSideExpanded(!e.getSideExpanded())},onExit:function(){this.getView().removeEventDelegate(this._navContainerDelegate);this._navContainerDelegate=null}})});
//# sourceMappingURL=Main.controller.js.map